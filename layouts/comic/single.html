<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ .Title }} | STUDIO MeowToon</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="hugo-episode">Episode {{ .Params.episode }}</div>
  <div class="hugo-title">{{ .Title }}</div>
  <div class="hugo-images">
    {{ range .Params.images }}
      <img src="{{ . | relURL }}" alt="comic panel">
    {{ end }}
    {{ .Content }}
    {{ with .Params.description }}
      <div class="hugo-description">{{ . }}</div>
    {{ end }}
  </div>
  <div class="hugo-nav">
  {{ with .NextInSection }}<a href="{{ .RelPermalink }}">◀️ Prev</a>{{ else }}<span></span>{{ end }}
  <a href="{{ .Parent.RelPermalink }}">⤴️ List</a>
  {{ with .PrevInSection }}<a href="{{ .RelPermalink }}">Next ▶️</a>{{ else }}<span></span>{{ end }}
  </div>
  <script>
  // スワイプで前後話に遷移（斜めも許容、判定緩め）
  let touchStartX = null;
  let touchStartY = null;
  document.addEventListener('touchstart', function(e) {
    touchStartX = e.changedTouches[0].screenX;
    touchStartY = e.changedTouches[0].screenY;
  });
  document.addEventListener('touchend', function(e) {
    if (touchStartX === null || touchStartY === null) return;
    let dx = e.changedTouches[0].screenX - touchStartX;
    let dy = e.changedTouches[0].screenY - touchStartY;
    // 横方向の動きが縦の0.7倍以上なら左右スワイプとみなす
    if (Math.abs(dx) > Math.abs(dy) * 0.7 && Math.abs(dx) > 40) {
      if (dx > 0) {
        // 右スワイプ: 前の話
        let prev = document.querySelector('.hugo-nav a:first-child');
        if (prev && prev.getAttribute('href')) location.href = prev.getAttribute('href');
      } else {
        // 左スワイプ: 次の話
        let next = document.querySelector('.hugo-nav a:last-child');
        if (next && next.getAttribute('href')) location.href = next.getAttribute('href');
      }
    }
    touchStartX = null;
    touchStartY = null;
  });
  </script>
</body>
</html>
